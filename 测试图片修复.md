# 图片修复测试指南

## 🎯 测试目标

验证以下三个问题是否已修复：
1. ✅ 购买记录页面 - 评论提交时商品图片显示
2. ✅ 商家管理后台 - 商品列表图片显示和删除功能
3. ✅ 收藏列表页面 - 商品图片显示

## 📋 测试前准备

### 1. 启动后端服务
确保Spring Boot后端服务运行在 `http://localhost:8080`

### 2. 启动Vue前端
```bash
cd E:/zip/htmlcsstranformervue
npm run dev
```

### 3. 准备测试数据
- 至少1个用户账号（有购买记录）
- 至少1个商家账号（有商品）
- 至少1个收藏的商品

## 🧪 测试用例

### 测试1: 购买记录 - 评论图片显示

#### 步骤：
1. 打开浏览器访问 `http://localhost:3000`
2. 登录用户账号
3. 点击导航栏 "购买记录"
4. 找到一个未评价的商品
5. 点击 "评价" 按钮
6. 观察评论弹窗

#### 预期结果：
- ✅ 评论弹窗正常打开
- ✅ 弹窗中显示商品图片
- ✅ 商品名称正确显示
- ✅ 可以选择评分（1-5星）
- ✅ 可以输入评论内容
- ✅ 可以选择匿名评论
- ✅ 提交评论成功

#### 检查点：
```
□ 评论弹窗显示
□ 商品图片显示（不是占位图）
□ 商品名称正确
□ 评分功能正常
□ 提交成功
```

#### 截图位置：
- 评论弹窗（显示商品图片）
- 提交成功提示

---

### 测试2: 商家管理后台 - 商品列表图片

#### 步骤：
1. 退出当前用户
2. 访问 `http://localhost:3000/merchant-login`
3. 登录商家账号
4. 进入商家管理后台
5. 查看商品列表

#### 预期结果：
- ✅ 商品列表正常显示
- ✅ 每个商品都显示缩略图
- ✅ 图片清晰可见（不是占位图）
- ✅ 商品信息完整

#### 检查点：
```
□ 商品列表加载成功
□ 所有商品图片显示
□ 图片尺寸合适
□ 图片清晰度良好
```

#### 截图位置：
- 商品列表页面（显示多个商品图片）

---

### 测试3: 商家管理后台 - 删除商品

#### 步骤：
1. 在商家管理后台
2. 选择一个测试商品
3. 点击 "删除" 按钮
4. 确认删除
5. 观察结果

#### 预期结果：
- ✅ 弹出确认对话框
- ✅ 确认后商品被删除
- ✅ 列表自动刷新
- ✅ 删除的商品不再显示
- ✅ 其他商品图片仍然正常显示

#### 检查点：
```
□ 确认对话框显示
□ 删除成功提示
□ 列表自动刷新
□ 商品已删除
□ 其他商品图片正常
```

#### 截图位置：
- 删除前的商品列表
- 删除后的商品列表

---

### 测试4: 收藏列表 - 商品图片

#### 步骤：
1. 退出商家账号
2. 登录用户账号
3. 点击导航栏 "我的收藏"
4. 查看收藏列表

#### 预期结果：
- ✅ 收藏列表正常显示
- ✅ 每个商品都显示图片
- ✅ 图片清晰可见（不是占位图）
- ✅ 点击图片可跳转到商品详情

#### 检查点：
```
□ 收藏列表加载成功
□ 所有商品图片显示
□ 图片尺寸合适
□ 点击跳转正常
```

#### 截图位置：
- 收藏列表页面（显示商品图片）

---

## 🔍 调试方法

### 如果图片不显示：

#### 1. 检查浏览器控制台
按 `F12` 打开开发者工具，查看：

**Console 标签**：
```
是否有错误信息？
是否有图片加载失败的警告？
```

**Network 标签**：
```
筛选 Img 类型
查看图片请求状态码（应该是 200）
查看图片URL是否正确
```

#### 2. 检查图片路径
在Console中输入：
```javascript
// 查看Records页面的数据
console.log(records.value)

// 查看商家后台的商品数据
console.log(products.value)

// 查看收藏列表数据
console.log(favorites.value)
```

#### 3. 检查后端返回
在Network标签中找到API请求，查看响应数据：
```json
{
  "products": [
    {
      "id": 1,
      "productName": "笔记本电脑",
      "imagePath": "laptop.jpg"  // 检查这个字段
    }
  ]
}
```

#### 4. 手动测试图片URL
复制图片的完整URL，在新标签页打开，看是否能访问。

---

## 📊 测试结果记录表

| 测试项 | 状态 | 备注 |
|--------|------|------|
| 购买记录 - 评论图片显示 | ⏳ 待测试 | |
| 购买记录 - 评论提交成功 | ⏳ 待测试 | |
| 商家后台 - 商品列表图片 | ⏳ 待测试 | |
| 商家后台 - 删除商品功能 | ⏳ 待测试 | |
| 商家后台 - 删除后图片显示 | ⏳ 待测试 | |
| 收藏列表 - 商品图片显示 | ⏳ 待测试 | |
| 收藏列表 - 点击跳转功能 | ⏳ 待测试 | |

### 状态说明：
- ⏳ 待测试
- ✅ 通过
- ❌ 失败
- ⚠️ 部分通过

---

## 🐛 常见问题

### Q1: 图片显示为占位图
**原因**: 
- 后端返回的图片路径不正确
- 图片文件不存在
- 图片路径格式不支持

**解决方法**:
1. 检查后端返回的 `imagePath` 字段
2. 确认图片文件存在于 `src/assets/images/` 目录
3. 查看 `src/utils/imageHelper.js` 中的路径映射

### Q2: 图片请求404
**原因**:
- 图片文件不存在
- Vite代理配置不正确
- 后端图片路径错误

**解决方法**:
1. 检查 `vite.config.js` 中的代理配置
2. 确认后端图片服务正常
3. 检查图片文件路径

### Q3: 评论弹窗不显示图片
**原因**:
- `record.imagePath` 为空
- 图片路径处理失败

**解决方法**:
1. 检查购买记录数据中是否包含 `imagePath`
2. 查看 `openReviewModal` 函数中的图片路径赋值
3. 添加调试日志查看实际值

### Q4: 商家后台图片不显示
**原因**:
- `fetchProducts` 没有处理图片路径
- 后端返回数据格式不正确

**解决方法**:
1. 确认已导入 `processProductImages`
2. 确认在 `fetchProducts` 中使用了图片处理
3. 检查后端返回的数据结构

---

## ✅ 测试完成检查清单

完成所有测试后，确认以下内容：

### 功能测试
- [ ] 购买记录评论图片正常显示
- [ ] 评论提交功能正常
- [ ] 商家后台商品列表图片显示
- [ ] 商家删除商品功能正常
- [ ] 删除后列表刷新正常
- [ ] 收藏列表图片正常显示
- [ ] 收藏列表跳转功能正常

### 兼容性测试
- [ ] Chrome浏览器测试通过
- [ ] Firefox浏览器测试通过
- [ ] Edge浏览器测试通过

### 性能测试
- [ ] 图片加载速度正常
- [ ] 页面响应速度正常
- [ ] 无内存泄漏

### 错误处理
- [ ] 图片加载失败显示占位图
- [ ] 网络错误有提示
- [ ] 操作失败有提示

---

## 📝 测试报告模板

```
测试日期: ___________
测试人员: ___________
浏览器版本: ___________

测试结果：
1. 购买记录评论图片: [ ] 通过 [ ] 失败
   问题描述: ___________

2. 商家后台商品图片: [ ] 通过 [ ] 失败
   问题描述: ___________

3. 商家删除商品功能: [ ] 通过 [ ] 失败
   问题描述: ___________

4. 收藏列表商品图片: [ ] 通过 [ ] 失败
   问题描述: ___________

总体评价: [ ] 全部通过 [ ] 部分通过 [ ] 未通过

备注: ___________
```

---

## 🎉 测试通过标准

所有测试项都满足以下条件：
- ✅ 功能正常运行
- ✅ 图片正常显示
- ✅ 无JavaScript错误
- ✅ 无网络请求失败
- ✅ 用户体验良好

**祝测试顺利！** 🚀

