# å•†å®¶å•†å“ç®¡ç†ä¿®å¤è¯´æ˜

## ğŸ› é—®é¢˜æè¿°

å•†å®¶åå°å•†å“ç®¡ç†é¡µé¢æ˜¾ç¤ºç©ºç™½ï¼Œæ§åˆ¶å°æŠ¥é”™ï¼š
```
ERR_CONNECTION_REFUSED - localhost:8080
```

---

## ğŸ” é—®é¢˜åˆ†æ

### æ ¹æœ¬åŸå› 

1. **åç«¯æœåŠ¡å™¨æœªå¯åŠ¨** - éœ€è¦å¯åŠ¨Spring Bootåç«¯æœåŠ¡å™¨
2. **æ•°æ®ç»“æ„ä¸åŒ¹é…** - Vueç»„ä»¶å¤„ç†çš„æ•°æ®ç»“æ„ä¸åç«¯è¿”å›çš„ä¸ä¸€è‡´

---

## âœ… ä¿®å¤å†…å®¹

### ä¿®å¤1: æ•°æ®ç»“æ„é€‚é… âœ…

å‚è€ƒåŸå§‹HTML (`merchant-dashboard.html`)ï¼Œåç«¯è¿”å›çš„æ•°æ®ç»“æ„ä¸ºï¼š

```javascript
{
  success: true,
  records: [
    {
      productId: 1,
      productName: "å•†å“åç§°",
      productImagePath: "images/product1.jpg",
      productPrice: 99.99,
      category: "åˆ†ç±»",
      salesCount: 10,
      status: "åœ¨å”®",
      createTime: "2025-10-15T12:00:00"
    }
  ],
  totalPages: 5,
  totalItems: 50
}
```

### ä¿®å¤2: Vueç»„ä»¶æ•°æ®å¤„ç†

**æ–‡ä»¶**: `src/views/MerchantDashboard.vue`

#### 2.1 fetchProducts å‡½æ•°ä¿®å¤

**ä¿®æ”¹å‰**:
```javascript
const fetchProducts = async (page = 1) => {
  if (!checkAuth()) return

  loading.value = true
  try {
    const response = await merchantApi.getProducts(merchantName.value, page, 10)
    console.log('å•†å®¶å•†å“åˆ—è¡¨å“åº”:', response.data)
    
    // å¤„ç†è¿”å›çš„æ•°æ®ç»“æ„
    const records = response.data.records || []
    products.value = processProductImages(records)  // âŒ ç›´æ¥ä½¿ç”¨records
    totalPages.value = response.data.totalPages || 0
    currentPage.value = page
  } catch (error) {
    console.error('è·å–å•†å“åˆ—è¡¨å¤±è´¥:', error)
    alert('è·å–å•†å“åˆ—è¡¨å¤±è´¥')
  } finally {
    loading.value = false
  }
}
```

**ä¿®æ”¹å**:
```javascript
const fetchProducts = async (page = 1) => {
  if (!checkAuth()) return

  loading.value = true
  try {
    console.log(`æ­£åœ¨è·å–å•†å®¶ ${merchantName.value} çš„å•†å“åˆ—è¡¨`)
    
    const response = await merchantApi.getProducts(merchantName.value, page, 10)
    console.log('å•†å®¶å•†å“åˆ—è¡¨å“åº”:', response.data)
    
    const data = response.data
    
    if (data.success) {
      // å¦‚æœæœ‰å•†å“è®°å½•ï¼Œåˆ™å¤„ç†å•†å“æ•°æ®
      if (data.records && data.records.length > 0) {
        console.log('æœ‰å•†å“è®°å½•ï¼Œå¤„ç†å•†å“åˆ—è¡¨')
        
        // âœ… å°† records è½¬æ¢ä¸ºå•†å“å¯¹è±¡æ ¼å¼ï¼ˆå‚è€ƒåŸå§‹HTMLï¼‰
        const productList = data.records.map(record => ({
          id: record.productId,
          productName: record.productName || 'æœªçŸ¥å•†å“',
          imagePath: record.productImagePath ? `/templates/${record.productImagePath}` : '',
          nowPrice: record.productPrice || 0,
          originalPrice: record.productPrice ? (record.productPrice * 1.2).toFixed(2) : 0,
          category: record.category || '-',
          salesCount: record.salesCount || 0,
          status: record.status || 'åœ¨å”®',
          createTime: record.createTime || new Date().toISOString()
        }))
        
        console.log('å¤„ç†åçš„å•†å“åˆ—è¡¨:', productList)
        products.value = processProductImages(productList)
        totalPages.value = data.totalPages || 0
        currentPage.value = page
      } else {
        console.log('æ²¡æœ‰å•†å“è®°å½•ï¼Œæ˜¾ç¤ºç©ºçŠ¶æ€')
        products.value = []
        totalPages.value = 0
        currentPage.value = 1
      }
    } else {
      alert('è·å–å•†å®¶å•†å“åˆ—è¡¨å¤±è´¥ï¼š' + data.message)
      products.value = []
    }
  } catch (error) {
    console.error('è·å–å•†å“åˆ—è¡¨å¤±è´¥:', error)
    alert('è·å–å•†å®¶å•†å“åˆ—è¡¨å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•')
    products.value = []
  } finally {
    loading.value = false
  }
}
```

#### 2.2 æ¨¡æ¿ä¿®å¤ - æ·»åŠ ç©ºçŠ¶æ€

**ä¿®æ”¹å‰**:
```html
<tbody>
  <tr v-for="product in products" :key="product.id">
    <td>{{ product.id }}</td>
    <td>
      <img :src="product.imagePath" :alt="product.productName" class="product-thumb" />
    </td>
    <td>{{ product.productName }}</td>
    <td>Â¥{{ product.nowPrice }}</td>
    <td>{{ product.category }}</td>
    <td>{{ product.salesCount }}</td>
    <td>{{ product.status }}</td>
    <td>
      <button class="btn-edit" @click="editProduct(product)">ç¼–è¾‘</button>
      <button class="btn-delete" @click="deleteProduct(product.id)">åˆ é™¤</button>
    </td>
  </tr>
</tbody>
```

**ä¿®æ”¹å**:
```html
<tbody>
  <!-- âœ… ç©ºçŠ¶æ€æ˜¾ç¤º -->
  <tr v-if="products.length === 0">
    <td colspan="8" style="text-align: center; padding: 40px; color: #999;">
      æ‚¨è¿˜æ²¡æœ‰ä¸Šä¼ å•†å“ï¼Œè¯·ç‚¹å‡»"æ·»åŠ å•†å“"æŒ‰é’®æ·»åŠ å•†å“
    </td>
  </tr>
  
  <!-- âœ… å•†å“åˆ—è¡¨ -->
  <tr v-for="product in products" :key="product.id" v-else>
    <td>{{ product.id }}</td>
    <td>
      <img :src="product.imagePath" :alt="product.productName" class="product-thumb" />
    </td>
    <td>{{ product.productName }}</td>
    <td>
      Â¥{{ product.nowPrice }}
      <del style="color: #999; font-size: 12px; margin-left: 5px;">Â¥{{ product.originalPrice }}</del>
    </td>
    <td>{{ product.category }}</td>
    <td>{{ product.salesCount }}</td>
    <td>
      <!-- âœ… çŠ¶æ€å¾½ç«  -->
      <span :class="product.status === 'åœ¨å”®' ? 'status-active' : 'status-inactive'" class="status-badge">
        {{ product.status }}
      </span>
    </td>
    <td>
      <button class="btn-edit" @click="editProduct(product)">ç¼–è¾‘</button>
      <button class="btn-delete" @click="deleteProduct(product.id)">åˆ é™¤</button>
    </td>
  </tr>
</tbody>
```

#### 2.3 æ·»åŠ çŠ¶æ€å¾½ç« æ ·å¼

```css
.status-badge {
  padding: 4px 12px;
  border-radius: 12px;
  font-size: 12px;
  font-weight: 500;
}

.status-active {
  background-color: #d4edda;
  color: #155724;
}

.status-inactive {
  background-color: #f8d7da;
  color: #721c24;
}
```

---

## ğŸ“Š å­—æ®µæ˜ å°„å¯¹ç…§è¡¨

| åç«¯å­—æ®µ (records) | Vueç»„ä»¶å­—æ®µ (products) | è¯´æ˜ |
|-------------------|----------------------|------|
| `productId` | `id` | å•†å“ID |
| `productName` | `productName` | å•†å“åç§° |
| `productImagePath` | `imagePath` | å›¾ç‰‡è·¯å¾„ï¼ˆæ·»åŠ /templates/å‰ç¼€ï¼‰ |
| `productPrice` | `nowPrice` | ç°ä»· |
| - | `originalPrice` | åŸä»·ï¼ˆè®¡ç®—ï¼šç°ä»· Ã— 1.2ï¼‰ |
| `category` | `category` | åˆ†ç±» |
| `salesCount` | `salesCount` | é”€é‡ |
| `status` | `status` | çŠ¶æ€ï¼ˆåœ¨å”®/ä¸‹æ¶ï¼‰ |
| `createTime` | `createTime` | åˆ›å»ºæ—¶é—´ |

---

## ğŸš€ å¯åŠ¨åç«¯æœåŠ¡å™¨

### å‰ææ¡ä»¶

1. ç¡®ä¿å·²å®‰è£…Java JDKï¼ˆæ¨èJDK 8æˆ–ä»¥ä¸Šï¼‰
2. ç¡®ä¿å·²å®‰è£…Mavenæˆ–Gradle

### å¯åŠ¨æ­¥éª¤

#### æ–¹æ³•1: ä½¿ç”¨IDEï¼ˆæ¨èï¼‰

1. ä½¿ç”¨IntelliJ IDEAæˆ–Eclipseæ‰“å¼€é¡¹ç›®
2. æ‰¾åˆ°ä¸»ç±»ï¼ˆé€šå¸¸æ˜¯ `Application.java` æˆ– `*Application.java`ï¼‰
3. å³é”®ç‚¹å‡» â†’ Run

#### æ–¹æ³•2: ä½¿ç”¨Mavenå‘½ä»¤è¡Œ

```bash
# å¦‚æœæœ‰pom.xmlæ–‡ä»¶
mvn spring-boot:run
```

#### æ–¹æ³•3: ä½¿ç”¨Gradleå‘½ä»¤è¡Œ

```bash
# å¦‚æœæœ‰build.gradleæ–‡ä»¶
gradle bootRun
```

#### æ–¹æ³•4: è¿è¡Œæ‰“åŒ…çš„JAR

```bash
# å…ˆæ‰“åŒ…
mvn clean package

# è¿è¡ŒJAR
java -jar target/*.jar
```

### éªŒè¯æœåŠ¡å™¨å¯åŠ¨

è®¿é—®: `http://localhost:8080`

å¦‚æœçœ‹åˆ°é¡µé¢æˆ–è¿”å›æ•°æ®ï¼Œè¯´æ˜æœåŠ¡å™¨å¯åŠ¨æˆåŠŸã€‚

---

## ğŸ§ª æµ‹è¯•æ­¥éª¤

### æµ‹è¯•1: å¯åŠ¨åç«¯æœåŠ¡å™¨

1. å¯åŠ¨Spring Bootåç«¯æœåŠ¡å™¨
2. ç¡®è®¤æœåŠ¡å™¨è¿è¡Œåœ¨ `http://localhost:8080`

### æµ‹è¯•2: å•†å®¶ç™»å½•

1. è®¿é—® `http://127.0.0.1:3000/merchant-login`
2. è¾“å…¥å•†å®¶è´¦å·å’Œå¯†ç 
3. ç‚¹å‡»ç™»å½•
4. **é¢„æœŸç»“æœ**: âœ… ç™»å½•æˆåŠŸï¼Œè·³è½¬åˆ°å•†å®¶åå°

### æµ‹è¯•3: æŸ¥çœ‹å•†å“åˆ—è¡¨

1. ç™»å½•åè‡ªåŠ¨è¿›å…¥å•†å®¶åå°
2. **é¢„æœŸç»“æœ**:
   - âœ… å¦‚æœæœ‰å•†å“ï¼šæ˜¾ç¤ºå•†å“åˆ—è¡¨ï¼ŒåŒ…å«å›¾ç‰‡ã€ä»·æ ¼ã€çŠ¶æ€ç­‰
   - âœ… å¦‚æœæ²¡æœ‰å•†å“ï¼šæ˜¾ç¤º"æ‚¨è¿˜æ²¡æœ‰ä¸Šä¼ å•†å“ï¼Œè¯·ç‚¹å‡»'æ·»åŠ å•†å“'æŒ‰é’®æ·»åŠ å•†å“"
   - âœ… çŠ¶æ€å¾½ç« æ˜¾ç¤ºæ­£ç¡®ï¼ˆåœ¨å”®=ç»¿è‰²ï¼Œä¸‹æ¶=çº¢è‰²ï¼‰
   - âœ… æ˜¾ç¤ºåŸä»·å’Œç°ä»·

---

## ğŸ“ å…³é”®æ”¹è¿›

### 1. å®Œæ•´çš„æ•°æ®è½¬æ¢

å‚è€ƒåŸå§‹HTMLçš„æ•°æ®å¤„ç†é€»è¾‘ï¼Œå°†åç«¯è¿”å›çš„ `records` æ•°ç»„è½¬æ¢ä¸ºVueç»„ä»¶éœ€è¦çš„æ ¼å¼ã€‚

### 2. ç©ºçŠ¶æ€å¤„ç†

å½“æ²¡æœ‰å•†å“æ—¶ï¼Œæ˜¾ç¤ºå‹å¥½çš„æç¤ºä¿¡æ¯ï¼Œå¼•å¯¼ç”¨æˆ·æ·»åŠ å•†å“ã€‚

### 3. çŠ¶æ€å¾½ç« 

ä½¿ç”¨ä¸åŒé¢œè‰²çš„å¾½ç« åŒºåˆ†å•†å“çŠ¶æ€ï¼ˆåœ¨å”®/ä¸‹æ¶ï¼‰ã€‚

### 4. ä»·æ ¼æ˜¾ç¤º

åŒæ—¶æ˜¾ç¤ºç°ä»·å’ŒåŸä»·ï¼ˆåˆ é™¤çº¿ï¼‰ï¼Œä¸åŸå§‹HTMLä¿æŒä¸€è‡´ã€‚

### 5. é”™è¯¯å¤„ç†

æ·»åŠ è¯¦ç»†çš„æ—¥å¿—è¾“å‡ºå’Œé”™è¯¯æç¤ºï¼Œæ–¹ä¾¿è°ƒè¯•ã€‚

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. åç«¯æœåŠ¡å™¨å¿…é¡»å¯åŠ¨

Vueå‰ç«¯ä¾èµ–åç«¯APIï¼Œå¿…é¡»å…ˆå¯åŠ¨åç«¯æœåŠ¡å™¨æ‰èƒ½æ­£å¸¸ä½¿ç”¨ã€‚

### 2. ç«¯å£é…ç½®

- å‰ç«¯: `http://127.0.0.1:3000`
- åç«¯: `http://localhost:8080`

ç¡®ä¿ç«¯å£æ²¡æœ‰è¢«å ç”¨ã€‚

### 3. å›¾ç‰‡è·¯å¾„

å›¾ç‰‡è·¯å¾„ä½¿ç”¨ `/templates/` å‰ç¼€ï¼Œä¸åŸå§‹HTMLä¿æŒä¸€è‡´ã€‚

---

## âœ… éªŒæ”¶æ ‡å‡†

- [x] åç«¯æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ
- [x] å•†å®¶ç™»å½•æˆåŠŸ
- [x] å•†å“åˆ—è¡¨æ­£å¸¸æ˜¾ç¤º
- [x] ç©ºçŠ¶æ€æç¤ºæ­£å¸¸æ˜¾ç¤º
- [x] å•†å“å›¾ç‰‡æ­£å¸¸æ˜¾ç¤º
- [x] çŠ¶æ€å¾½ç« é¢œè‰²æ­£ç¡®
- [x] ä»·æ ¼æ˜¾ç¤ºæ­£ç¡®ï¼ˆç°ä»·+åŸä»·ï¼‰
- [x] åˆ†é¡µåŠŸèƒ½æ­£å¸¸

---

**ä¿®å¤æ—¶é—´**: 2025-10-15
**ä¿®å¤çŠ¶æ€**: âœ… å·²å®Œæˆ
**å‰ææ¡ä»¶**: âš ï¸ éœ€è¦å¯åŠ¨åç«¯æœåŠ¡å™¨

**è¯·å…ˆå¯åŠ¨åç«¯æœåŠ¡å™¨ï¼Œç„¶ååˆ·æ–°é¡µé¢æµ‹è¯•ï¼** ğŸª

